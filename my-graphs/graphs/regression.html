<!DOCTYPE html>
<html>
<head>
    <title>Linear Regression Graph</title>
    <!-- Load Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin-top: 40px;
            text-align: center;
        }
        /* Make sure the canvas takes full width and adjusts its height based on container size */
        #chartContainer {
            width: 100%;
            max-width: 800px; /* Set a max-width for the container */
            margin: 0 auto;
        }
        canvas {
            width: 100% !important; /* Make canvas width responsive */
            height: 400px; /* Default height, will adjust dynamically */
        }
    </style>
</head>
<body>
    <div id="chartContainer">
        <canvas id="myChart"></canvas>
    </div>

    <script>
        // Define less and more scattered data points
        const dataPoints = [
            { x: 1, y: 2.5 },
            { x: 3, y: 6.1 },
            { x: 4, y: 7.8 },
            { x: 5, y: 11.3 },
            { x: 6, y: 13.9 },
            { x: 7, y: 15.4 },
            { x: 9, y: 17.9 },
            { x: 10, y: 21.4 },
            { x: 12, y: 24.7 },
            { x: 14, y: 28.1 }
        ];

        // Manually calculate linear regression using least squares method
        function calculateRegression(data) {
            let n = data.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;

            data.forEach(point => {
                sumX += point.x;
                sumY += point.y;
                sumXY += point.x * point.y;
                sumX2 += point.x * point.x;
            });

            // Calculate slope (m) and y-intercept (b)
            let m = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            let b = (sumY - m * sumX) / n;

            return { slope: m, intercept: b };
        }

        // Get regression line data
        const regression = calculateRegression(dataPoints);
        const regressionLine = dataPoints.map(point => {
            return { x: point.x, y: regression.slope * point.x + regression.intercept };
        });

        // Prepare data for scatter plot
        const scatterData = {
            datasets: [
                {
                    data: dataPoints,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    pointRadius: 5,
                    type: 'scatter'
                },
                {
                    data: regressionLine,
                    type: 'line',
                    borderColor: 'red',
                    borderWidth: 2,
                    pointRadius: 0,
                    fill: false
                }
            ]
        };

        // Chart configuration
        const config = {
            type: 'scatter',
            data: scatterData,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false // Hides the legend
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: false // Hides the x-axis title
                        }
                    },
                    y: {
                        title: {
                            display: false // Hides the y-axis title
                        }
                    }
                }
            }
        };

        // Render chart
        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, config);

        // Dynamically adjust canvas height based on container width
        window.addEventListener('resize', function() {
            const containerWidth = document.getElementById('chartContainer').offsetWidth;
            const newHeight = containerWidth * 0.6; // Adjust the ratio to control height
            myChart.canvas.height = newHeight;
            myChart.update();
        });

        // Initial height adjustment
        const initialWidth = document.getElementById('chartContainer').offsetWidth;
        const initialHeight = initialWidth * 0.6; // Adjust the ratio to control height
        myChart.canvas.height = initialHeight;
        myChart.update();
    </script>
</body>
</html>
